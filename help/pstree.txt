Инструкция по pstree

Основные опции:
pstree — дерево процессов текущего пользователя
pstree -p — показать PID процессов
pstree -a — показать аргументы командной строки
pstree -c — не сворачивать одинаковые поддеревья
pstree -h — подсветить текущий процесс и его предков
pstree -H PID — подсветить указанный PID

Пользователи и группы:
pstree -u — показать пользователей (UID → имя)
pstree -g — показать группы процессов
pstree -G — использовать VT100 линии для дерева
pstree -U — использовать UTF-8 линии для дерева
pstree -l — длинный формат (не обрезать строки)

Формат вывода:
pstree -A — использовать ASCII символы для дерева
pstree -n — сортировать по PID (а не по имени)
pstree -Z — показать контекст SELinux

PID и процессы:
pstree PID — дерево для конкретного процесса
pstree пользователь — дерево процессов пользователя
pstree -s PID — показать родителей процесса
pstree -t — показать только имена (без PID)
pstree -T — скрыть потоки (только процессы)

Примеры:
pstree — простое дерево процессов
pstree -p — с PID всех процессов
pstree -ap — с PID и аргументами
pstree -uap — с пользователями, PID и аргументами
pstree -p 1 — дерево процессов от init/systemd (PID 1)
pstree -s $$ — показать родительскую цепочку текущей оболочки
pstree -H $$ — подсветить текущий процесс в дереве
pstree -u $(whoami) — дерево процессов текущего пользователя
pstree -c -p — развернутое дерево с PID
pstree -l — полные имена команд без обрезки
pstree -n -p — отсортировать по PID (цифровая сортировка)
pstree -Z — с метками SELinux
pstree -G — с графическими линиями (VT100)
pstree -U — с UTF-8 линиями

Специальные символы в выводе:
init или systemd — корневой процесс (PID 1)
getty — консольные входы
bash, zsh, fish — оболочки
sshd — SSH демон
thread- — потоки (если показаны)

Полезные комбинации:
pstree -p | grep -A5 -B5 sshd — найти sshd и окружение
pstree -ap | less — постраничный просмотр
pstree -u $(id -un) -p — процессы текущего пользователя с PID

Поиск процессов:
pstree -ap | grep -i nginx — найти nginx процессы
pstree -p | grep -E '[0-9]{4,5}' — найти процессы с большими PID

Сравнение с ps:
ps auxf — похожий вывод, но в другом формате
ps -ejH — иерархический вывод как у pstree

С потоковыми процессами:
Некоторые процессы показываются с потоками:
firefox─┬─{firefox} — firefox с потоками

Цветной вывод:
pstree -p | grep --color PID — подсветить определенный PID

Информация о версии:
pstree -V — версия pstree
pstree --help — справка

Пример полного вывода:
    pstree -apu
    systemd,1
      ├─sshd,1234 -D
      │   └─sshd,5678    
      │       └─bash,5679
      │           └─vim,5680 файл.txt
      └─nginx,2345
          ├─nginx,2346 worker process
          └─nginx,2347 worker process
          
Скрытые опции:
--show-pids — синоним -p
--arguments — синоним -a
--compact — не разворачивать одинаковые поддеревья

Ограничения:
pstree показывает процессы только в текущем namespace
Для Docker контейнеров нужно запускать внутри контейнера

Альтернативы:
htop — интерактивный просмотр дерева процессов
systemd-cgtop — просмотр по control groups

Проверка родителей:
pstree -s PID — полезно для отслеживания родительской цепочки процесса
