Инструкция по nmap

Основное сканирование:
nmap цель — простое сканирование
nmap цель1 цель2 — несколько целей
nmap 192.168.1.0/24 — сканирование подсети
nmap 192.168.1.1-100 — диапазон адресов

Типы сканирования:
nmap -sS цель — SYN сканирование (полуоткрытое)
nmap -sT цель — TCP подключение (полное)
nmap -sU цель — UDP сканирование
nmap -sA цель — ACK сканирование
nmap -sW цель — Window сканирование
nmap -sM цель — FIN/ACK сканирование

Обнаружение хостов:
nmap -sn цель — ping сканирование (только обнаружение)
nmap -Pn цель — не пинговать перед сканированием
nmap -PS порт цель — TCP SYN ping
nmap -PA порт цель — TCP ACK ping
nmap -PU порт цель — UDP ping

Порты:
nmap -p порт цель — сканировать конкретный порт
nmap -p 1-1000 цель — диапазон портов
nmap -p 22,80,443 цель — конкретные порты
nmap -p- цель — все 65535 портов
nmap -p U:53,T:1-1000 цель — смешанные порты
nmap -F цель — быстрое сканирование (100 популярных портов)

Определение ОС и служб:
nmap -O цель — определение операционной системы
nmap -sV цель — определение версий служб
nmap -A цель — агрессивное сканирование (OS, версии, скрипты)

Скрипты:
nmap -sC цель — запуск стандартных скриптов
nmap --script скрипт цель — запуск конкретного скрипта
nmap --script "http-*" цель — скрипты по шаблону

Скорость и время:
nmap -T0 цель — параноидально медленно
nmap -T1 цель — медленно
nmap -T2 цель — вежливо
nmap -T3 цель — нормально (по умолчанию)
nmap -T4 цель — агрессивно
nmap -T5 цель — безумно быстро

Вывод:
nmap -oN файл цель — обычный вывод в файл
nmap -oX файл цель — XML вывод
nmap -oG файл цель — grep-дружественный вывод
nmap -oA база цель — все форматы (normal, XML, grepable)
nmap -v цель — подробный вывод
nmap -vv цель — очень подробный

Обход защиты:
nmap -f цель — фрагментировать пакеты
nmap -D decoy1,decoy2,ME цель — сканирование с ложными целями
nmap -S поддельный_IP -e интерфейс цель — поддельный источник
nmap -g порт цель — указать исходный порт
nmap --data-length число цель — добавить случайные данные

Примеры:
nmap 192.168.1.1 — сканирование одного хоста
nmap -sS -sU -p 1-1000 192.168.1.1 — SYN + UDP сканирование
nmap -O -sV 192.168.1.1 — ОС и версии служб
nmap -A -T4 192.168.1.1 — агрессивное сканирование
nmap -p 22,80,443,8080 192.168.1.0/24 — сканирование подсети на конкретные порты
nmap -sn 192.168.1.0/24 — только обнаружение живых хостов
nmap -sU -p 53,67,68,161 192.168.1.1 — UDP сканирование важных портов
nmap --script vuln 192.168.1.1 — поиск уязвимостей
nmap --script=http-title 192.168.1.1 — получить заголовок веб-страницы
nmap -iL hosts.txt — сканирование из файла со списком хостов
nmap --exclude 192.168.1.100 192.168.1.0/24 — исключить хост

Специальные скрипты:
nmap --script dns-brute домен — brute force DNS
nmap --script ssh-brute цель — brute force SSH
nmap --script http-sql-injection цель — проверка SQL инъекций
nmap --script ssl-enum-ciphers -p 443 цель — проверка SSL шифров

Пакетная работа:
nmap --resume файл — продолжить прерванное сканирование

Цензура вывода:
nmap --reason цель — показать причину вывода портов

Интенсивность сканирования:
nmap --min-rate число цель — минимальная скорость пакетов/сек
nmap --max-rate число цель — максимальная скорость пакетов/сек

Профили:
nmap --min-parallelism число — минимальное параллельных проверок
nmap --max-parallelism число — максимальное параллельных проверок

Отладка:
nmap -d цель — отладочный вывод
nmap -dd цель — более подробный отладка

Пример полного сканирования:
nmap -sS -sU -T4 -A -v -p- 192.168.1.1 — полное сканирование хоста
