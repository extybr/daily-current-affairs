Инструкция по join

Основной синтаксис:
join файл1 файл2 — объединить два файла по общему полю
join -1 поле1 -2 поле2 файл1 файл2 — указать поля для соединения

Разделители:
join -t разделитель файл1 файл2 — указать разделитель полей
join -t $'\t' файл1 файл2 — табуляция как разделитель

Поля для соединения:
-1 N — поле N из первого файла
-2 N — поле N из второго файла
-j N — поле N из обоих файлов
-j1 N — поле N из первого файла
-j2 N — поле N из второго файла

Вывод:
join -o список_полей — указать поля для вывода
join -a номер_файла — вывести непарные строки из файла
join -v номер_файла — вывести только непарные строки
join -e строка — заменить пустые поля указанной строкой

Сортировка:
join требует отсортированные по ключу файлы
sort файл > отсортированный_файл — предварительная сортировка

Примеры:
join file1.txt file2.txt — объединить по первому полю
join -1 2 -2 3 file1.txt file2.txt — соединить по полю 2 из file1 и полю 3 из file2
join -t ',' file1.csv file2.csv — CSV файлы с запятой как разделителем
join -a 1 file1.txt file2.txt — все строки из file1, даже без совпадений
join -v 1 file1.txt file2.txt — только строки из file1 без совпадений в file2
join -o 1.1,2.2,1.3 file1.txt file2.txt — вывести поле1 из file1, поле2 из file2, поле3 из file1
join -e "N/A" file1.txt file2.txt — заменить пустые поля на "N/A"
join -i file1.txt file2.txt — игнорировать регистр ключей
join --header file1.txt file2.txt — считать первую строку заголовком
join -j 3 file1.txt file2.txt — соединить по третьему полю в обоих файлах

Пример данных:
    # file1.txt
    1 apple
    2 banana
    3 cherry

    # file2.txt
    1 red
    2 yellow
    3 red
    
join file1.txt file2.txt →
    1 apple red
    2 banana yellow  
    3 cherry red

Расширенный вывод:
join -o 0,1.2,2.2 file1.txt file2.txt — 0 = ключ, 1.2 = второе поле из file1, 2.2 = второе поле из file2

Объединение с заголовками:
    # names.txt
    id name
    1 Alice
    2 Bob

    # departments.txt
    id dept
    1 Engineering
    2 Sales

join --header names.txt departments.txt →
    id name dept
    1 Alice Engineering
    2 Bob Sales

Практические примеры:
join -t ':' /etc/passwd /etc/group — объединить пользователей и группы по GID (осторожно с сортировкой)
join -1 1 -2 1 <(sort file1) <(sort file2) — отсортировать на лету
join -a 1 -e "0" <(sort sales.txt) <(sort inventory.txt) — все продажи, даже без инвентаря
join -v 1 customers.txt orders.txt — клиенты без заказов

Множественные файлы:
join file1.txt file2.txt | join - file3.txt — цепочка объединений

Разделитель по умолчанию:
Пробел/табуляция, последовательные разделители считаются одним

Игнорирование регистра:
join -i или --ignore-case — полезно для email, имен и т.д.

Проверка сортировки:
join --check-order file1.txt file2.txt — проверить что файлы отсортированы
join --nocheck-order — не проверять сортировку

Пустые поля:
join -e "NULL" — заменить пустые поля в выводе

Формат поля в -o:
ФАЙЛ.ПОЛЕ — например: 1.2, 2.3, 0 (0 = ключевое поле)

Пример с разными ключами:
    # prices.txt
    item price
    apple 1.00
    banana 0.50

    # quantities.txt  
    item qty
    apple 10
    banana 5
    
join --header -o 0,1.2,2.2 prices.txt quantities.txt →
    item price qty
    apple 1.00 10
    banana 0.50 5

Сложное объединение:
join -t '|' -1 3 -2 2 -o '1.1,1.2,2.1,2.3' file1 file2

Проверка:
join --version — версия
join --help — справка

Важно:
    Файлы должны быть отсортированы по ключевому полю
    По умолчанию используется первое поле
    Разделитель по умолчанию — пробелы/табуляции
    join не работает с неотсортированными файлами (без --nocheck-order)
