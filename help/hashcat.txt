Инструкция по hashcat

Основной синтаксис:
hashcat -m тип_хеша -a тип_атаки хеш словарь
hashcat -m 0 -a 0 hash.txt rockyou.txt — атака по словарю

Типы хешей (-m):
-m 0 — MD5
-m 1000 — NTLM
-m 1400 — SHA256
-m 1800 — SHA512
-m 22000 — WPA/WPA2
-m 2500 — WPA-EAPOL-PBKDF2
-m 3200 — bcrypt
-m 13100 — Kerberos 5 TGS-REP
-m 5500 — NetNTLMv1
-m 5600 — NetNTLMv2

Типы атак (-a):
-a 0 — атака по словарю (Dictionary)
-a 1 — комбинация словарей (Combinator)
-a 3 — брутфорс (Brute-force)
-a 6 — гибридная: словарь + маска
-a 7 — гибридная: маска + словарь
-a 9 — ассоциативная атака (Association)

Маски для брутфорса (-a 3):
?l — строчные буквы (a-z)
?u — заглавные буквы (A-Z)
?d — цифры (0-9)
?s — специальные символы
?a — все печатные символы
?h — hex цифры строчные (0-9, a-f)
?H — hex цифры заглавные (0-9, A-F)
?b — все байты (0x00-0xff)

Примеры масок:
?l?l?l?l?l — 5 строчных букв
?u?l?l?l?d?d — Заглавная + 3 строчные + 2 цифры
password?d?d — password + 2 цифры

Оптимизация:
-O — оптимизированный режим (меньше масок)
-w 1 — низкая нагрузка (для фона)
-w 2 — средняя нагрузка
-w 3 — высокая нагрузка
-w 4 — максимальная нагрузка

Аппаратное ускорение:
-D 1 — использовать только CPU
-D 2 — использовать только GPU
-D 1,2 — использовать CPU и GPU

Управление сессиями:
--session имя — имя сессии
--restore — восстановить сессию
--restore-file-path=файл — файл для восстановления

Вывод:
--show — показать взломанные хеши
--left — показать оставшиеся хеши
--outfile=файл — сохранить результаты
--outfile-format=N — формат вывода (1=hash:pass, 2=pass, 3=both)
-o файл — сокращение для --outfile

Правила:
-r rules/hybrid.rule — применить правило к словарю
-j правило — правило с левой стороны
-k правило — правило с правой стороны

Пример правил:
u — сделать первую букву заглавной
$1 — добавить цифру 1 в конец
^! — добавить ! в начало

Примеры команд:
hashcat -m 0 -a 0 hash.txt rockyou.txt — MD5 словарная атака
hashcat -m 1000 -a 0 ntlm_hash.txt dictionary.txt — NTLM атака
hashcat -m 22000 capture.hccapx rockyou.txt — WPA словарная атака
hashcat -m 0 -a 3 hash.txt ?l?l?l?l?l?l — MD5 брутфорс 6 букв
hashcat -m 0 -a 6 hash.txt dict.txt ?d?d — гибрид: словарь + 2 цифры
hashcat -m 1400 -a 0 sha256.txt -r rules/best64.rule — с правилами
hashcat -m 0 hash.txt --show — показать взломанные MD5
hashcat -m 2500 -a 3 capture.hccapx ?d?d?d?d?d?d?d?d — WPA брутфорс 8 цифр
hashcat -m 13100 kirbi_file.txt -w 3 -O — Kerberos с оптимизацией

Подготовка хешей:
Для WPA: hcxpcapngtool -o hash.hc22000 capture.pcap
Для NTLM: формат user:hash или просто hash

Статус:
hashcat -I — информация об устройствах
hashcat -b — бенчмарк
hashcat --version — версия

Потоковая обработка:
echo "hash" | hashcat -m 0 -a 0 - — хеш из stdin

Работа с базой хешей:
hashcat -m 0 hash.txt --username — игнорировать имена пользователей в файле

Перебор масок:
hashcat -m 0 -a 3 hash.txt -1 ?l?d ?1?1?1?1?1?1 — пользовательский charset

Пример файла хешей:
    5f4dcc3b5aa765d61d8327deb882cf99
    e10adc3949ba59abbe56e057f20f883e
    
Режимы восстановления:
hashcat --potfile-path=файл — указать файл pot
hashcat --remove — удалить взломанные хеши из файла

Версии:
hashcat — CPU версия
hashcat --force — принудительно запустить (если ошибка)

Важные опции:
--skip — пропускать уже проверенные комбинации
--limit — ограничить количество попыток
--status — автоматически обновлять статус
--status-timer=N — интервал обновления статуса в секундах
--quiet — тихий режим
--hex-charset — charset в hex формате

Пример WPA атаки:
    hashcat -m 22000 -a 3 capture.hccapx ?d?d?d?d?d?d?d?d -w 3 -O
